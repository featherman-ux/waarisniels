---
// src/components/ViewCounter.astro
import { apiUrl } from '../lib/api';
const ENDPOINT = apiUrl('/api/view');
---
<span id="views-chip" class="chip">ðŸ‘€ 0</span>

<script is:inline>
  (async () => {
    const el = document.getElementById('views-chip');
    if (!el) return;
    const endpoint = {e: JSON.stringify(ENDPOINT)}.e;
    try {
      const r = await fetch(`${endpoint}?path=${encodeURIComponent(location.pathname)}`);
      const j = await r.json();
      el.textContent = `ðŸ‘€ ${j.views ?? 0}`;
    } catch {}
  })();
</script>

<style>
  .chip {
    background:#f1f5f9; border:1px solid #e5e7eb; color:#0f172a;
    padding:.3rem .65rem; border-radius:9999px; font-size:.85rem; font-weight:600;
  }
</style>