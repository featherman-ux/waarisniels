---
// src/pages/blog/[slug].astro
import { getCollection, getEntry } from 'astro:content';
import BlogPostLayout from '../../layouts/BlogPostLayout.astro';
import type { CollectionEntry } from 'astro:content';

// This function is required for Astro to generate static pages from dynamic routes
export async function getStaticPaths() {
  const posts = await getCollection('blog', ({ data }) => {
    return data.draft!== true; // Only generate pages for non-draft posts
  });

  return posts.map(post => ({
    params: { slug: post.slug }, // `slug` is automatically generated by Astro from the filename
    props: { post },
  }));
}

// Type assertion for Astro.props
interface Props {
  post: CollectionEntry<'blog'>;
}
const { post } = Astro.props as Props; // Type assertion
const { Content } = await post.render(); // Get the component to render MD/MDX content
---

<BlogPostLayout post={post}>
  <Content /> {/* This renders the Markdown/MDX content of the post */}
</BlogPostLayout>